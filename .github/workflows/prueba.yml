name: Basic HTML Check
on:
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  html-check:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      
    steps:
      - name: Get code
        uses: actions/checkout@v4
        
      - name: Extract title
        run: |
          echo "Looking for title in index.html..."
          title=$(grep -o '<title>[^<]*</title>' index.html | sed 's/<[^>]*>//g')
          echo "Found title: $title"
          echo "$title" > title.txt
          
      - name: Count HTML elements
        run: |
          echo "Counting HTML elements..."
          divs=$(grep -c '<div' index.html || echo 0)
          images=$(grep -c '<img' index.html || echo 0)
          links=$(grep -c '<a' index.html || echo 0)
          
          echo "DIVs: $divs"
          echo "Images: $images" 
          echo "Links: $links"
          
          echo "HTML Stats:" > stats.txt
          echo "DIVs: $divs" >> stats.txt
          echo "Images: $images" >> stats.txt
          echo "Links: $links" >> stats.txt
          
      - name: Add timestamp
        run: |
          echo "Adding build time..."
          echo "<!-- Last updated: $(date) -->" >> index.html
          
      - name: Save changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Update HTML stats"
          file_pattern: "*.txt index.html"
